{% extends './base.html' %}
{% block content %}
<script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
crossorigin="anonymous"></script>'

<!-- Style for modal -->
<style>
  .modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  }

  /* Modal Content/Box */
  .modal-content {
    background-color: #fefefe;
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Could be more or less, depending on screen size */
  }

  /* The Close Button */
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }

</style>

<!-- --------------------- -->

<!-- The modal -->

<div id="detailsModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>Some text in the Modal..</p>
  </div>

</div>

<!-- ------------ -->


<!-- wysiwyg text editor -->




<!-- ---------------- -->


<!-- Filter select options and button -->

<select class="form-control" id='filter'>
  <option selected='selected'>All</option>
  {% for mdepartment in department %}
    <option>{{mdepartment.department_name}}</option>
  {%endfor%}
</select>
<button class="btn btn-dark" id='filterbtn'>Filter</button>

<!-- ------------------- -->


<h3>Welcome {{request.user}} <a href="{% url 'logout' %}" class='btn btn-primary'>Logout</a></h3>
  <p> <p>



<table class="table table-borderless">
  <tr>
    <th>Name</th>
    <th>Department</th>
    <th colspan="2">Action </th>

  </tr>
  {% for mstudent in students %}
    <tr id='{{ mstudent.id }}'>
      <td>{{mstudent}}</td>
      <td>{{mstudent.department.department_name}}</td>
      <td><button class='btn btn-primary viewButton'>View</button>
          <button class='btn btn-primary generateButton'>Generate</button></td>
    </tr>
  {% endfor %}
</table>


<script>
  var modal = $('#detailsModal')

  $('.close').click(function(e){
      modal.css('display', 'none');
  })

  $('.viewButton').click(function(e){
      id=$(this).parent().parent().attr('id');
      id=parseInt(id)
      console.log(id);
      console.log("{% for mstudent in students %}
        {{mstudent.id}}
        {%endfor%}");
      modal.css('display','block');
  })


  $('.generateButton').click(function (e) {
    id = $(this).prev().parent().parent().attr('id');
    $.ajax({
      url: "{% url 'generate' %}",
      type: 'GET',
      data: {
        'id': id
      },
      success: function (data) {
        $('#editor').css('display','block');
      }
    })
  })
</script>



{% endblock %}
